% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_td_with_power.R
\name{simulate_td_with_power}
\alias{simulate_td_with_power}
\title{Simulate Target Dose Estimation and Power Across Efficacy Scenarios}
\usage{
simulate_td_with_power(
  pMods,
  sigma,
  doses,
  delta_grid,
  models_to_estimate = c("emax", "sigEmax"),
  n = 100,
  go_threshold = 1,
  separation_threshold = 0.3,
  nSim = 100
)
}
\arguments{
\item{pMods}{A single \code{Mods} object or a named list of \code{Mods} objects with different max effect levels.}

\item{sigma}{Standard deviation of the outcome.}

\item{doses}{Numeric vector of dose levels used in the study.}

\item{delta_grid}{Vector of Delta values for which target dose estimation will be evaluated.}

\item{models_to_estimate}{Character vector of model types to fit (default includes common parametric models).}

\item{n}{Sample size. Can be a vector. When a single number is specified for ‘⁠n⁠’ it is assumed this is the sample size per group and balanced allocations are used.}

\item{go_threshold}{Minimum meaningful effect (Delta) required to support a "go" decision.}

\item{separation_threshold}{Minimum difference used for pairwise posterior probability evaluations.}

\item{nSim}{Number of simulation replicates.}
}
\value{
A list where each entry corresponds to a \code{MaxEff} scenario and contains:
\itemize{
\item \code{target_dose_estimation}: list with \code{data} and a \code{description}
\item \code{posterior_probabilities}: list with \code{data} and a \code{description}
\item \code{pairwise_comparisons}: list with \code{data} and a \code{description}
\item \code{target_dose_summary}: list with \code{table} and a \code{description}
\item \code{planMod_output}: raw output from planMod()
\item \code{predictions_df}: matrix of simulated dose-response predictions
\item \code{dose_response_quantiles_long}: predictive quantile summaries per simulation
}
}
\description{
This function runs simulation-based target dose estimation and posterior probability analysis
under multiple efficacy scenarios defined by varying MaxEff values in a \code{Mods} object.
}
\examples{
doses <- c(0, 5, 40, 80, 160)
MaxEff_vals <- c(3, 4)
pMods <- setNames(lapply(MaxEff_vals, function(maxEff) {
  DoseFinding::Mods(
    emax = 80,
    sigEmax = c(50, 3.5),
    quadratic = -0.004,
    placEff = 4,
    maxEff = maxEff,
    doses = doses
  )
}), paste0("MaxEff_", MaxEff_vals))

results <- simulate_td_with_power(
  pMods = pMods,
  sigma = 0.3,
  doses = doses,
  delta_grid = c(0.5, 1, 1.5),
  go_threshold = 1.5,
  separation_threshold = 0.3,
  nSim = 100
)
results$MaxEff_3$target_dose_summary$table
}
