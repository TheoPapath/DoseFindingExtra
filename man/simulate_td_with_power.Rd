% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_td_with_power.R
\name{simulate_td_with_power}
\alias{simulate_td_with_power}
\title{Simulate Target Dose Estimation and Power Across Efficacy Scenarios}
\usage{
simulate_td_with_power(
  pMods,
  sigma,
  doses_cmc_1,
  delta_grid,
  models_to_estimate = c("betaMod", "emax", "sigEmax", "linlog"),
  ratio = c(3, 1, 1, 1, 3),
  n_per_arm = 450,
  go_threshold = 1.5,
  separation_threshold = 0.3,
  nSim = 100
)
}
\arguments{
\item{pMods}{Named list of \code{Mods} objects with different max effect levels.}

\item{sigma}{Standard deviation of the outcome.}

\item{doses_cmc_1}{Numeric vector of dose levels used in the study.}

\item{delta_grid}{Vector of Delta values for which target dose estimation will be evaluated.}

\item{models_to_estimate}{Character vector of model types to fit (default includes common parametric models).}

\item{ratio}{Numeric vector specifying allocation ratio per dose.}

\item{n_per_arm}{Sample size per allocation unit.}

\item{go_threshold}{Minimum meaningful effect (Delta) required to support a "go" decision.}

\item{separation_threshold}{Minimum difference used for pairwise posterior probability evaluations.}

\item{nSim}{Number of simulation replicates.}
}
\value{
A list where each entry corresponds to a \code{MaxEff} scenario and contains:
\itemize{
\item \code{summary_data}: quantiles of estimated target doses
\item \code{posterior_power}: summary of power for detecting meaningful differences vs placebo
\item \code{posterior_power_grand}: matrix of pairwise posterior comparisons across doses
\item \code{td_summary_formatted}: formatted table of true vs estimated target doses with CIs
}
}
\description{
This function runs simulation-based target dose estimation and posterior probability analysis
under multiple efficacy scenarios defined by varying MaxEff values in a \code{Mods} object.
}
\examples{
doses <- c(0, 5, 40, 80, 160)
MaxEff_vals <- c(3, 4)
pMods <- setNames(lapply(MaxEff_vals, function(maxEff) {
  Mods(
    emax = 80,
    sigEmax = c(50, 3.5),
    quadratic = -0.004,
    placEff = 4,
    maxEff = maxEff,
    doses = doses
  )
}), paste0("MaxEff_", MaxEff_vals))

results <- simulate_td_with_power(
  pMods = pMods,
  sigma = 5,
  doses_cmc_1 = doses,
  delta_grid = c(0.5, 1, 1.5),
  go_threshold = 1.5,
  separation_threshold = 0.3,
  nSim = 100
)
results$MaxEff_3$td_summary_formatted
}
